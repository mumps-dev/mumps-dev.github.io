<?xml version="1.0" encoding="ISO-8859-1"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en"><head><title>The Annotated M[UMPS] Standards</title></head>
<body bgcolor="#4c76ac" text="#ecd264" link="#bca234" vlink="#bca234">
<form method="post" action="AnnoStd.html">
<input type="hidden" name="Frame" value="Search"/>
<input type="text" name="Search" size="20"/>
<input type="submit" value="Search"/></form><table width="91%"><tr>
<td width="13%" align="center"><a href="AnnoStd%EF%B9%96Frame=Main&amp;Page=a108040&amp;Edition=1977.html"><img alt="Button for 1977" border="0" src="../image/AnnoStd/1977a.gif"/></a></td>
<td width="13%" align="center"><a href="AnnoStd%EF%B9%96Frame=Main&amp;Page=a108040&amp;Edition=1984.html"><img alt="Button for 1984" border="0" src="../image/AnnoStd/1984a.gif"/></a></td>
<td width="13%" align="center"><img alt="Button for 1990" border="0" src="../image/AnnoStd/1990d.gif"/></td>
<td width="13%" align="center"><a href="AnnoStd%EF%B9%96Frame=Main&amp;Page=a108040&amp;Edition=1995.html"><img alt="Button for 1995" border="0" src="../image/AnnoStd/1995a.gif"/></a></td>
<td width="13%" align="center"><a href="AnnoStd%EF%B9%96Frame=Main&amp;Page=a108040&amp;Edition=MDC.html"><img alt="Button for MDC" border="0" src="../image/AnnoStd/MDCa.gif"/></a></td>
<td width="13%" align="center"><a href="AnnoStd%EF%B9%96Frame=Main&amp;Page=a108040&amp;Edition=notes.html"><img alt="Button for notes" border="0" src="../image/AnnoStd/notesa.gif"/></a></td>
<td width="13%" align="center"><a href="AnnoStd%EF%B9%96Frame=Main&amp;Page=a108040&amp;Edition=examples.html"><img alt="Button for examples" border="0" src="../image/AnnoStd/examplesa.gif"/></a></td></tr>
<tr><td align="center"><a href="AnnoStd%EF%B9%96Frame=Main&amp;Page=a108037&amp;Edition=1990.html"><span style="font-size: 72px">&#9756;</span></a></td><td colspan="5" align="center"><h2>LOCK</h2><h3>1990 Version of ANSI Standard</h3></td><td align="center"><a href="AnnoStd%EF%B9%96Frame=Main&amp;Page=a108042&amp;Edition=1990.html"><span style="font-size: 72px">&#9758;</span></a></td></tr></table><a name="Def_0001"></a>
<a name="Def_0002"></a>
<a name="Def_0003"></a>
<h3>2.6.12 <a href="AnnoStd%EF%B9%96Frame=Main&amp;Edition=1990&amp;Page=a108040.html#Def_0003">Lock</a></h3>
<table><tr>
<td align="center">L[OCK] <a href="AnnoStd%EF%B9%96Frame=Main&amp;Edition=1990&amp;Page=a108005.html#Def_0001"><u>postcond</u></a></td>
<td align="center">&#9474;<br/>&#9474;<br/>&#9474;</td>
<td align="center">[ <a href="AnnoStd%EF%B9%96Frame=Main&amp;Edition=1990&amp;Page=a105001.html#Def_0003"><u>SP</u></a> ]<br/>
<a href="AnnoStd%EF%B9%96Frame=Main&amp;Edition=1990&amp;Page=a105001.html#Def_0003"><u>SP</u></a> <a href="AnnoStd%EF%B9%96Frame=Main&amp;Edition=1990&amp;Page=a105001.html#Def_0001"><u>L</u></a> <a href="AnnoStd%EF%B9%96Frame=Main&amp;Edition=1990&amp;Page=a108040.html#Def_0004"><u>lockargument</u></a></td>
<td align="center">&#9474;<br/>&#9474;<br/>&#9474;</td>
</tr></table>
<p>See 2.5.1 for the definition of <a href="AnnoStd%EF%B9%96Frame=Main&amp;Edition=1990&amp;Page=a108005.html#Def_0001"><u>postcond</u></a>. See section 1
for the definition of <a href="AnnoStd%EF%B9%96Frame=Main&amp;Edition=1990&amp;Page=a105001.html#Def_0001"><u>L</u></a>.</p>
<a name="Def_0004"></a>
<table><tr><td align="center">&nbsp;&nbsp;&nbsp;</td>
<td align="center"><a href="AnnoStd%EF%B9%96Frame=Main&amp;Edition=1990&amp;Page=a108040.html#Def_0004"><u>lockargument</u></a></td><td align="center">::=</td>
<td align="center">&#9474;<br/>&#9474;<br/>&#9474;<br/>&#9474;<br/>&#9474;<br/>&#9474;</td>
<td align="center"><table><tr>
<td align="center">&#9484;<br/>&#9474;<br/>&#9492;</td>
<td align="center">+<br/>
-</td>
<td align="center">&#9488;<br/>&#9474;<br/>&#9496;</td>
<td align="center">&#9474;<br/>&#9474;<br/>&#9474;</td>
<td align="center"><a href="AnnoStd%EF%B9%96Frame=Main&amp;Edition=1990&amp;Page=a108040.html#Def_0005"><u>nref</u></a><br/>
( <a href="AnnoStd%EF%B9%96Frame=Main&amp;Edition=1990&amp;Page=a105001.html#Def_0001"><u>L</u></a> <a href="AnnoStd%EF%B9%96Frame=Main&amp;Edition=1990&amp;Page=a108040.html#Def_0005"><u>nref</u></a> )</td>
<td align="center">&#9474;<br/>&#9474;<br/>&#9474;</td>
<td align="center">[ <a href="AnnoStd%EF%B9%96Frame=Main&amp;Edition=1990&amp;Page=a108008.html#Def_0001"><u>timeout</u></a> ]</td>
</tr></table><br/>
@ <a href="AnnoStd%EF%B9%96Frame=Main&amp;Edition=1990&amp;Page=a107002.html#Def_0001"><u>expratom</u></a> <a href="AnnoStd%EF%B9%96Frame=Main&amp;Edition=1990&amp;Page=a105001.html#Def_0002"><u>V</u></a> <a href="AnnoStd%EF%B9%96Frame=Main&amp;Edition=1990&amp;Page=a105001.html#Def_0001"><u>L</u></a> <a href="AnnoStd%EF%B9%96Frame=Main&amp;Edition=1990&amp;Page=a108040.html#Def_0004"><u>lockargument</u></a> </td>
<td align="center">&#9474;<br/>&#9474;<br/>&#9474;<br/>&#9474;<br/>&#9474;<br/>&#9474;</td>
</tr></table>
<p>See 2.6.12 for the definition of <a href="AnnoStd%EF%B9%96Frame=Main&amp;Edition=1990&amp;Page=a108040.html#Def_0005"><u>nref</u></a>. See 2.5.6 for
the definition of <a href="AnnoStd%EF%B9%96Frame=Main&amp;Edition=1990&amp;Page=a108008.html#Def_0001"><u>timeout</u></a>. See 2.2 for the definition of
<a href="AnnoStd%EF%B9%96Frame=Main&amp;Edition=1990&amp;Page=a107002.html#Def_0001"><u>expratom</u></a>. See section 1 for the definition of <a href="AnnoStd%EF%B9%96Frame=Main&amp;Edition=1990&amp;Page=a105001.html#Def_0002"><u>V</u></a>.
See section 1 for the definition of <a href="AnnoStd%EF%B9%96Frame=Main&amp;Edition=1990&amp;Page=a105001.html#Def_0001"><u>L</u></a>.</p>
<a name="Def_0005"></a>
<table><tr><td align="center">&nbsp;&nbsp;&nbsp;</td>
<td align="center"><a href="AnnoStd%EF%B9%96Frame=Main&amp;Edition=1990&amp;Page=a108040.html#Def_0005"><u>nref</u></a></td><td align="center">::=</td>
<td align="center">&#9474;<br/>&#9474;<br/>&#9474;</td>
<td align="center">[ ^ ] <a href="AnnoStd%EF%B9%96Frame=Main&amp;Edition=1990&amp;Page=a106002.html#Def_0001"><u>name</u></a> [ ( <a href="AnnoStd%EF%B9%96Frame=Main&amp;Edition=1990&amp;Page=a105001.html#Def_0001"><u>L</u></a> <a href="AnnoStd%EF%B9%96Frame=Main&amp;Edition=1990&amp;Page=a107001.html#Def_0001"><u>expr</u></a> ) ]<br/>
@ <a href="AnnoStd%EF%B9%96Frame=Main&amp;Edition=1990&amp;Page=a107002.html#Def_0001"><u>expratom</u></a> <a href="AnnoStd%EF%B9%96Frame=Main&amp;Edition=1990&amp;Page=a105001.html#Def_0002"><u>V</u></a> <a href="AnnoStd%EF%B9%96Frame=Main&amp;Edition=1990&amp;Page=a108040.html#Def_0005"><u>nref</u></a></td>
<td align="center">&#9474;<br/>&#9474;<br/>&#9474;</td>
</tr></table>
<p>See 2.2.1 for the definition of <a href="AnnoStd%EF%B9%96Frame=Main&amp;Edition=1990&amp;Page=a106002.html#Def_0001"><u>name</u></a>. See 2.3 for the
definition of <a href="AnnoStd%EF%B9%96Frame=Main&amp;Edition=1990&amp;Page=a107001.html#Def_0001"><u>expr</u></a>. See 2.2 for the definition of
<a href="AnnoStd%EF%B9%96Frame=Main&amp;Edition=1990&amp;Page=a107002.html#Def_0001"><u>expratom</u></a>. See 2.6.12 for the definition of <a href="AnnoStd%EF%B9%96Frame=Main&amp;Edition=1990&amp;Page=a108040.html#Def_0005"><u>nref</u></a>.
See section 1 for the definition of <a href="AnnoStd%EF%B9%96Frame=Main&amp;Edition=1990&amp;Page=a105001.html#Def_0002"><u>V</u></a>. See section 1 for
the definition of <a href="AnnoStd%EF%B9%96Frame=Main&amp;Edition=1990&amp;Page=a105001.html#Def_0001"><u>L</u></a>.</p>
<p><a href="AnnoStd%EF%B9%96Frame=Main&amp;Edition=1990&amp;Page=a108040.html#Def_0003">Lock</a> provides a generalized interlock facility
available to concurrently executing MUMPS processes to be used as
appropriate to the applications being programmed. Execution of
<a href="AnnoStd%EF%B9%96Frame=Main&amp;Edition=1990&amp;Page=a108040.html#Def_0003">Lock</a> is not affected by, nor does it directly affect, the
state or value of any global or local variable, or the value of
the <a href="AnnoStd%EF%B9%96Frame=Main&amp;Edition=1990&amp;Page=a107011.html#Def_0004">naked indicator</a>. Its use is not required to access globals,
nor does its use inhibit other processes from accessing globals.
It is an interlocking mechanism whose use depends on programmers
establishing and following conventions.</p>
<p>Each <a href="AnnoStd%EF%B9%96Frame=Main&amp;Edition=1990&amp;Page=a108040.html#Def_0004"><u>lockargument</u></a> specifies a subspace of the total
MUMPS name space for which the executing process seeks to make or
release an exclusive claim; the details of this subspace
specification are given below.</p>
<p>For the purposes of this discussion, <i>name space</i> is
herein defined as the union of all possible <a href="AnnoStd%EF%B9%96Frame=Main&amp;Edition=1990&amp;Page=a108040.html#Def_0005"><u>nref</u></a>s after
resolution of all indirection. There exists a table, called the
locktable, which contains zero or more <a href="AnnoStd%EF%B9%96Frame=Main&amp;Edition=1990&amp;Page=a108040.html#Def_0005"><u>nref</u></a>s for each
MUMPS process. A given <a href="AnnoStd%EF%B9%96Frame=Main&amp;Edition=1990&amp;Page=a108040.html#Def_0005"><u>nref</u></a> may appear more than once for
the same process and it may not appear for multiple processes.
Each <a href="AnnoStd%EF%B9%96Frame=Main&amp;Edition=1990&amp;Page=a108040.html#Def_0005"><u>nref</u></a> represents a claim on a portion of the name
space. The subspace of the total name space claimed by each
<a href="AnnoStd%EF%B9%96Frame=Main&amp;Edition=1990&amp;Page=a108040.html#Def_0005"><u>nref</u></a> in the locktable is as follows:</p>
<ol type="a">
<li>If the occurrence of <a href="AnnoStd%EF%B9%96Frame=Main&amp;Edition=1990&amp;Page=a108040.html#Def_0005"><u>nref</u></a> is unsubscripted,
then the subspace is the set of the following points: one point
for the unsubscripted variable name <a href="AnnoStd%EF%B9%96Frame=Main&amp;Edition=1990&amp;Page=a108040.html#Def_0005"><u>nref</u></a> and one point for
each subscripted variable name
<i>N</i>(<i>s</i><sub>1</sub>,...,<i>s<sub>i</sub></i>) for which
<i>N</i> has the same spelling as <a href="AnnoStd%EF%B9%96Frame=Main&amp;Edition=1990&amp;Page=a108040.html#Def_0005"><u>nref</u></a>.</li>
<li>If the occurrence of <a href="AnnoStd%EF%B9%96Frame=Main&amp;Edition=1990&amp;Page=a108040.html#Def_0005"><u>nref</u></a> is subscripted, let
the <a href="AnnoStd%EF%B9%96Frame=Main&amp;Edition=1990&amp;Page=a108040.html#Def_0005"><u>nref</u></a> be
<i>N</i>(<i>s</i><sub>1</sub>,<i>s</i><sub>2</sub>,...,<i>s<sub>n</sub></i>).
Then the subspace is the set of the following points: one point
for each of <i>N</i>, <i>N</i>(<i>s</i><sub>1</sub>),
<i>N</i>(<i>s</i><sub>1</sub>,<i>s</i><sub>2</sub>),...,<i>N</i>(<i>s</i><sub>1</sub>,...,<i>s<sub>i</sub></i>),
where <i>i</i> '&gt; <i>n</i>, and one point for each descendant
(see 2.2.7 <a href="AnnoStd%EF%B9%96Frame=Main&amp;Edition=1990&amp;Page=a107086.html#Def_0003">$Data</a> function for a definition of descendant)
of <a href="AnnoStd%EF%B9%96Frame=Main&amp;Edition=1990&amp;Page=a108040.html#Def_0005"><u>nref</u></a>.</li>
</ol>
<p>If the <a href="AnnoStd%EF%B9%96Frame=Main&amp;Edition=1990&amp;Page=a108040.html#Def_0003">Lock</a> <a href="AnnoStd%EF%B9%96Frame=Main&amp;Edition=1990&amp;Page=a108001.html#Def_0001"><u>command</u></a> is argumentless, <a href="AnnoStd%EF%B9%96Frame=Main&amp;Edition=1990&amp;Page=a108040.html#Def_0003">Lock</a>
removes all <a href="AnnoStd%EF%B9%96Frame=Main&amp;Edition=1990&amp;Page=a108040.html#Def_0005"><u>nref</u></a>s in the locktable that are associated
with this process.</p>
<p>Execution of <a href="AnnoStd%EF%B9%96Frame=Main&amp;Edition=1990&amp;Page=a108040.html#Def_0004"><u>lockargument</u></a> occurs in the following
order:</p>
<ol type="a">
<li>Any expression evaluation involved in processing the
<a href="AnnoStd%EF%B9%96Frame=Main&amp;Edition=1990&amp;Page=a108040.html#Def_0004"><u>lockargument</u></a> is performed.</li>
<li>When the form of <a href="AnnoStd%EF%B9%96Frame=Main&amp;Edition=1990&amp;Page=a108040.html#Def_0004"><u>lockargument</u></a> does not include
an initial + or - sign, then prior to evaluating or executing the
rest of the <a href="AnnoStd%EF%B9%96Frame=Main&amp;Edition=1990&amp;Page=a108040.html#Def_0004"><u>lockargument</u></a>, <a href="AnnoStd%EF%B9%96Frame=Main&amp;Edition=1990&amp;Page=a108040.html#Def_0003">Lock</a> first removes all
<a href="AnnoStd%EF%B9%96Frame=Main&amp;Edition=1990&amp;Page=a108040.html#Def_0005"><u>nref</u></a>s in the locktable that are associated with this
process. For the rest of the discussion, this form acts the same
as if an initial + sign were present.</li>
<li>If an explicit or implicit leading + sign is present,
then:
<ol type="1">
<li>A test is made to see if this process can
claim the entire subspace defined by the <a href="AnnoStd%EF%B9%96Frame=Main&amp;Edition=1990&amp;Page=a108040.html#Def_0004"><u>lockargument</u></a>.
This subspace can be claimed if each <a href="AnnoStd%EF%B9%96Frame=Main&amp;Edition=1990&amp;Page=a108040.html#Def_0005"><u>nref</u></a> of the
<a href="AnnoStd%EF%B9%96Frame=Main&amp;Edition=1990&amp;Page=a108040.html#Def_0004"><u>lockargument</u></a> does not intersect the union of the subspaces
claimed at this instant by <a href="AnnoStd%EF%B9%96Frame=Main&amp;Edition=1990&amp;Page=a108040.html#Def_0005"><u>nref</u></a>s in the locktable for all
other processes.</li>
<li>If the test performed above indicates that
the process cannot claim the specified subspace, execution of
this process is suspended until repetition of the test would
indicate that the process can claim the specified subspace, or,
when a <a href="AnnoStd%EF%B9%96Frame=Main&amp;Edition=1990&amp;Page=a108008.html#Def_0001"><u>timeout</u></a> is present, until the <a href="AnnoStd%EF%B9%96Frame=Main&amp;Edition=1990&amp;Page=a108008.html#Def_0001"><u>timeout</u></a>
expires, if that occurs first. If the <a href="AnnoStd%EF%B9%96Frame=Main&amp;Edition=1990&amp;Page=a108008.html#Def_0001"><u>timeout</u></a> expires,
step 3 below is skipped.</li>
<li>All of the <a href="AnnoStd%EF%B9%96Frame=Main&amp;Edition=1990&amp;Page=a108040.html#Def_0005"><u>nref</u></a>s in the
<a href="AnnoStd%EF%B9%96Frame=Main&amp;Edition=1990&amp;Page=a108040.html#Def_0004"><u>lockargument</u></a> are inserted into the locktable for this
process. This may result in some <a href="AnnoStd%EF%B9%96Frame=Main&amp;Edition=1990&amp;Page=a108040.html#Def_0005"><u>nref</u></a>s being in the table
more than once for this process. The <a href="AnnoStd%EF%B9%96Frame=Main&amp;Edition=1990&amp;Page=a108040.html#Def_0005"><u>nref</u></a>s for the
<a href="AnnoStd%EF%B9%96Frame=Main&amp;Edition=1990&amp;Page=a108040.html#Def_0004"><u>lockargument</u></a> are either inserted all at once or not at
all.</li>
</ol></li>
<li>If the <a href="AnnoStd%EF%B9%96Frame=Main&amp;Edition=1990&amp;Page=a108040.html#Def_0004"><u>lockargument</u></a> has a leading - sign, then
for each <a href="AnnoStd%EF%B9%96Frame=Main&amp;Edition=1990&amp;Page=a108040.html#Def_0005"><u>nref</u></a> in the <a href="AnnoStd%EF%B9%96Frame=Main&amp;Edition=1990&amp;Page=a108040.html#Def_0004"><u>lockargument</u></a>, if the
<a href="AnnoStd%EF%B9%96Frame=Main&amp;Edition=1990&amp;Page=a108040.html#Def_0005"><u>nref</u></a> exists in the locktable for this process, one
instance of <a href="AnnoStd%EF%B9%96Frame=Main&amp;Edition=1990&amp;Page=a108040.html#Def_0005"><u>nref</u></a> is removed from the locktable.</li>
<li>If a <a href="AnnoStd%EF%B9%96Frame=Main&amp;Edition=1990&amp;Page=a108008.html#Def_0001"><u>timeout</u></a> is present, the condition
reported by <a href="AnnoStd%EF%B9%96Frame=Main&amp;Edition=1990&amp;Page=a107074.html#Def_0001">$T</a> upon completion of the
execution of the <a href="AnnoStd%EF%B9%96Frame=Main&amp;Edition=1990&amp;Page=a108040.html#Def_0004"><u>lockargument</u></a> is the success or failure to
establish or relinquish the claim; it has the value of 1 if the
lock claim is established or 0 if the <a href="AnnoStd%EF%B9%96Frame=Main&amp;Edition=1990&amp;Page=a108008.html#Def_0001"><u>timeout</u></a> expires. If
no <a href="AnnoStd%EF%B9%96Frame=Main&amp;Edition=1990&amp;Page=a108008.html#Def_0001"><u>timeout</u></a> is present, execution of the
<a href="AnnoStd%EF%B9%96Frame=Main&amp;Edition=1990&amp;Page=a108040.html#Def_0004"><u>lockargument</u></a> does not change <a href="AnnoStd%EF%B9%96Frame=Main&amp;Edition=1990&amp;Page=a107074.html#Def_0001">$T</a>.</li>
</ol>
<table width="91%"><tr>
<td width="13%" align="center"><a href="AnnoStd%EF%B9%96Frame=Main&amp;Page=a108040&amp;Edition=1977.html"><img alt="Button for 1977" border="0" src="../image/AnnoStd/1977a.gif"/></a></td>
<td width="13%" align="center"><a href="AnnoStd%EF%B9%96Frame=Main&amp;Page=a108040&amp;Edition=1984.html"><img alt="Button for 1984" border="0" src="../image/AnnoStd/1984a.gif"/></a></td>
<td width="13%" align="center"><img alt="Button for 1990" border="0" src="../image/AnnoStd/1990d.gif"/></td>
<td width="13%" align="center"><a href="AnnoStd%EF%B9%96Frame=Main&amp;Page=a108040&amp;Edition=1995.html"><img alt="Button for 1995" border="0" src="../image/AnnoStd/1995a.gif"/></a></td>
<td width="13%" align="center"><a href="AnnoStd%EF%B9%96Frame=Main&amp;Page=a108040&amp;Edition=MDC.html"><img alt="Button for MDC" border="0" src="../image/AnnoStd/MDCa.gif"/></a></td>
<td width="13%" align="center"><a href="AnnoStd%EF%B9%96Frame=Main&amp;Page=a108040&amp;Edition=notes.html"><img alt="Button for notes" border="0" src="../image/AnnoStd/notesa.gif"/></a></td>
<td width="13%" align="center"><a href="AnnoStd%EF%B9%96Frame=Main&amp;Page=a108040&amp;Edition=examples.html"><img alt="Button for examples" border="0" src="../image/AnnoStd/examplesa.gif"/></a></td></tr></table>
<p>Copyright &copy; Standard Documents; 1977-2023 MUMPS Development Committee;<br/>
Copyright &copy; Examples: 1995-2023 Ed de Moel;<br/>
Copyright &copy; Annotations: 2003-2008 Jacquard Systems Research<br/>
Copyright &copy; Annotations: 2008-2023 Ed de Moel.</p>
<p><font size="-1">This page most recently updated on 13-Sep-2014, 17:15:51.</font></p>
<p>For comments, <a href="mailto:demoel@jacquardsystems.com?Subject=Annotated%20Standards%20%28Frame%3dMain%2fPage%3da108040%2fEdition%3d1990%29">contact Ed de Moel (demoel@jacquardsystems.com)</a></p>
</body>
</html>
