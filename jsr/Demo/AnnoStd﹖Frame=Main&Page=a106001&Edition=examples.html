<?xml version="1.0" encoding="ISO-8859-1"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en"><head><title>The Annotated M[UMPS] Standards</title></head>
<body bgcolor="#4c76ac" text="#ecd264" link="#bca234" vlink="#bca234">
<form method="post" action="AnnoStd.html">
<input type="hidden" name="Frame" value="Search"/>
<input type="text" name="Search" size="20"/>
<input type="submit" value="Search"/></form><table width="91%"><tr>
<td width="13%" align="center"><a href="AnnoStd%EF%B9%96Frame=Main&amp;Page=a106001&amp;Edition=1977.html"><img alt="Button for 1977" border="0" src="../image/AnnoStd/1977a.gif"/></a></td>
<td width="13%" align="center"><a href="AnnoStd%EF%B9%96Frame=Main&amp;Page=a106001&amp;Edition=1984.html"><img alt="Button for 1984" border="0" src="../image/AnnoStd/1984a.gif"/></a></td>
<td width="13%" align="center"><a href="AnnoStd%EF%B9%96Frame=Main&amp;Page=a106001&amp;Edition=1990.html"><img alt="Button for 1990" border="0" src="../image/AnnoStd/1990a.gif"/></a></td>
<td width="13%" align="center"><a href="AnnoStd%EF%B9%96Frame=Main&amp;Page=a106001&amp;Edition=1995.html"><img alt="Button for 1995" border="0" src="../image/AnnoStd/1995a.gif"/></a></td>
<td width="13%" align="center"><a href="AnnoStd%EF%B9%96Frame=Main&amp;Page=a106001&amp;Edition=MDC.html"><img alt="Button for MDC" border="0" src="../image/AnnoStd/MDCa.gif"/></a></td>
<td width="13%" align="center"><a href="AnnoStd%EF%B9%96Frame=Main&amp;Page=a106001&amp;Edition=notes.html"><img alt="Button for notes" border="0" src="../image/AnnoStd/notesa.gif"/></a></td>
<td width="13%" align="center"><img alt="Button for examples" border="0" src="../image/AnnoStd/examplesd.gif"/></td></tr>
<tr><td align="center"><a href="AnnoStd%EF%B9%96Frame=Main&amp;Page=a100006&amp;Edition=examples.html"><span style="font-size: 72px">&#9756;</span></a></td><td colspan="5" align="center"><h2><u>routine</u></h2><h3>M[UMPS] by Example</h3></td><td align="center"><a href="AnnoStd%EF%B9%96Frame=Main&amp;Page=a107008&amp;Edition=examples.html"><span style="font-size: 72px">&#9758;</span></a></td></tr></table><p>This little gem comes to us through Paul Kadow and John
Mitchell (original author unknown).
It was created when they worked at Digital Equipment
Corporation.</p>
<pre>
  ; The ultimate M[UMPS] program  --  self documenting
  ;
P R I N T S (A,L)=1,(S,T)=I N G
  G I V E N A      
O F A=L:L:S Q:U=A  R E S B=E L O W (A*A),!
I S (U,R,E)=T H 1 N K I T=S G O O D
  ;
</pre>
<p>Looking quickly at the letters in the code one might see a
suggestion that there is something with "prints a listing,
given <tt>A</tt>, of all squares below".<br/> The
<tt>A*A</tt> seems to confirm that.</p>
<p>Now let's have a real look:</p>
<p>The program starts out by reading a number into a local
variable (<tt>I</tt>) and copying that value into a couple of
other local variables (<tt>S</tt> and <tt>T</tt>).<br/>
In passing, two local variables are <a href="AnnoStd%EF%B9%96Frame=Main&amp;Edition=MDC&amp;Page=a108042.html#Def_0002">New</a>ed (<tt>T</tt> and
<tt>G</tt>)</p>
<p>The next line shows us one of the interesting ways of adding
comments to a M[UMPS] program without having to resort to inserting
a semi-colon: after a <a href="AnnoStd%EF%B9%96Frame=Main&amp;Edition=MDC&amp;Page=a108032.html#Def_0002">Goto</a> command, the rest of the line is not
executed, so the program GOes to label <tt>I</tt> and the
language processor ignores the text
<tt>V&nbsp;E&nbsp;N&nbsp;A</tt>.</p>
<p>At that line, three more variables receive the value that is
in local variable <tt>T</tt> (<tt>U</tt>, <tt>R</tt> and
<tt>E</tt>), which was the same as local variable <tt>I</tt>.</p>
<p>After all this hard labor, the language processor takes a
well-deserved rest (<a href="AnnoStd%EF%B9%96Frame=Main&amp;Edition=MDC&amp;Page=a108034.html#Def_0002">Hang</a> <tt>1</tt>).</p>
<p>Local variable <tt>K</tt> is <a href="AnnoStd%EF%B9%96Frame=Main&amp;Edition=MDC&amp;Page=a108042.html#Def_0002">New</a>ed, and if the values of local
variables <tt>T</tt> and <tt>S</tt> are equal (they were set to
the same value in the first line, so that is still the case), we
<a href="AnnoStd%EF%B9%96Frame=Main&amp;Edition=MDC&amp;Page=a108032.html#Def_0002">Goto</a> label <tt>O</tt> (and the language processor ignores the
"comment" <tt>O&nbsp;D</tt>, after all: OD-ing is not considered
desirable anyway).</p>
<p>At this line (<tt>O</tt>), there is a loop: local variable
<tt>A</tt> loops from the value 1 with steps of 1 until the value
of <tt>S</tt> (which is equal to the value of <tt>I</tt>, being
the value entered by the end-user in the very first line).<br/>
The loop has an alternate end: when the value of local variable
<tt>U</tt> is equal to local variable <tt>A</tt> (the
loop-counter), the loop ends.<br/>
This means that the final value that would result from
<tt>A=L:L:S</tt> (<tt>A</tt>=1:1:<tt>I</tt>) will signal the end
of the loop, and the square of <tt>I</tt> will never be printed
(but now I'm getting ahead of myself).</p>
<p>Next, the program reads another value into local variable
<tt>E</tt>, and copies that value into local variable 
<tt>B</tt>.<br/>
Then, a <a href="AnnoStd%EF%B9%96Frame=Main&amp;Edition=1990&amp;Page=a108040.html#Def_0003">Lock</a> command is issued: the name <tt>O</tt> is added to
the LOCK-table (or the program will wait until that is
possible).</p>
<p>Now we finally get to the purpose of the program: it writes
the value of <tt>A*A</tt> (the square of the loop-counter), and a
new-line code-sequence.</p>
<p>So, while the loop is active, the list of squares for the
numbers 1 through (<tt>I</tt>-1) will be displayed, waiting for
user-input before each number is printed.<br/>
When the loop is complete, the line with label <tt>I</tt> will be
executed again. Since none of the variables <tt>I</tt>,
<tt>T</tt> or <tt>S</tt> have received any new values, the loop
at line <tt>O</tt> will be repeated, and again, and again, and
again...</p>
<p>While this program is cute and fun, it also illustrates
a number of errors that are quite common in software (be it
written in M[UMPS] or any other programming language):</p>
<ul>
<li><b>Interactive <a href="AnnoStd%EF%B9%96Frame=Main&amp;Edition=MDC&amp;Page=a108045.html#Def_0002">Read</a> command without indication that
input is expected.</b><br/>
In the context of this sample program, it would defeat the
purpose to change the <tt>R&nbsp;I</tt> and <tt>R&nbsp;E</tt> to something
like: <tt>W&nbsp;"Highest&nbsp;number:&nbsp;"&nbsp;R&nbsp;I</tt> or
<tt>W&nbsp;"Continue?&nbsp;"&nbsp;R&nbsp;E</tt>, but as it is, is this program
would be executed, at both places it would be waiting for input
and the end-user would have no indication that an action on his/her
part is expected.<br/>
<b>Note</b>: when reading from non-interactive media such as files
and network-sockets, it is usually counter-effective to include
"prompts" before reading...</li>
<li><b>Counter-intuitive <a href="AnnoStd%EF%B9%96Frame=Main&amp;Edition=1990&amp;Page=a108044.html#Def_0003">Quit</a> condition</b><br/>
The command <tt>Q:U=A</tt> makes the loop end "one iteration earlier"
than one might expect.<br/>
Keep in mind that in M[UMPS] the <a href="AnnoStd%EF%B9%96Frame=Main&amp;Edition=MDC&amp;Page=a108031.html#Def_0002">For</a> command may be used in
many ways, leaving a big difference between these two options:<br/>
<tt><a href="AnnoStd%EF%B9%96Frame=Main&amp;Edition=MDC&amp;Page=a108031.html#Def_0002">For</a>&nbsp;...&nbsp;<a href="AnnoStd%EF%B9%96Frame=Main&amp;Edition=1990&amp;Page=a108044.html#Def_0003">Quit</a>:condition&nbsp;&nbsp;... code ...</tt><br/>
<tt><a href="AnnoStd%EF%B9%96Frame=Main&amp;Edition=MDC&amp;Page=a108031.html#Def_0002">For</a>&nbsp;...&nbsp;... code ...&nbsp;<a href="AnnoStd%EF%B9%96Frame=Main&amp;Edition=1990&amp;Page=a108044.html#Def_0003">Quit</a>:condition</tt><br/>
The former implements a "while" loop, and the latter implements
a "repeat until" loop.</li>
<li><b>Initializing unused local variables</b><br/>
In this sample program, statements like <tt>S (U,R,E)=T</tt>
are obviously intended to add specific letters to the "documentation".<br/>
In real life, however, all too often it happens that a programmer
has been taught that it is "good" to initialize all local variables,
and ends up initializing variables that will never be used afterwards.<br/>
Between the errors of not declaring and/or initializing variables that
<i>are</i> used, and initializing variables that <i>are not</i> used,
I'm not sure which transgression is worse (especially when the
unused local variables never get "cleaned up".</li>
<li><b><a href="AnnoStd%EF%B9%96Frame=Main&amp;Edition=1990&amp;Page=a108040.html#Def_0003">Lock</a> without <a href="AnnoStd%EF%B9%96Frame=Main&amp;Edition=MDC&amp;Page=a108008.html#Def_0001"><u>timeout</u></a></b><br/>
Of course, the <a href="AnnoStd%EF%B9%96Frame=Main&amp;Edition=1990&amp;Page=a108040.html#Def_0003">Lock</a> command in this program is without
any functional meaning, it just adds some letters that are
needed for the gimmick, but:<br/>
When there is a possibility that multiple users may attempt simultaneously 
to make modifications to the same database, a <a href="AnnoStd%EF%B9%96Frame=Main&amp;Edition=1990&amp;Page=a108040.html#Def_0003">Lock</a> command or
some other method of synchronization or
<a href="AnnoStd%EF%B9%96Frame=Main&amp;Edition=MDC&amp;Page=a106011.html#Def_0001">Transaction Processing</a> should be used.<br/>
However, if the name that is used in a <a href="AnnoStd%EF%B9%96Frame=Main&amp;Edition=1990&amp;Page=a108040.html#Def_0003">Lock</a> command might
be unavailable for an extended period, the code in this program
(<tt>L&nbsp;O</tt> could wait for a long time to obtain that lock,
wihout giving the end-user any idea about why the program is waiting.<br/>
<b>Note</b>: if a <a href="AnnoStd%EF%B9%96Frame=Main&amp;Edition=1990&amp;Page=a108040.html#Def_0003">Lock</a> command is used with a <a href="AnnoStd%EF%B9%96Frame=Main&amp;Edition=MDC&amp;Page=a108008.html#Def_0001"><u>timeout</u></a>,
appropriate action will need to be taken when the time-out period
elapses. There is an awful lot of code in production that just "forges on"
after the system has told it that "someone else owns this lock, do
<b>not</b> proceed"...</li>
<li><b>Results are presented without any indication of their meaning</b><br/>
This little program would present the squares of some integer numbers,
one number per line. (1, 4, 9, 16, ...). As long as it is clear that
this is what is expected, there is no issue with that.<br/>
If the result of the program is to be presented to an external party,
a table like:<pre>
Number   Square
   1       1
   2       4
   3       9
...</pre>
would communicate the same information much more effectively.</li>
</ul>
<p>Keeping those issues in mind, one might rewrite this code
as:</p>
<pre>
 <a href="AnnoStd%EF%B9%96Frame=Main&amp;Edition=MDC&amp;Page=a108042.html#Def_0002">New</a> i,max
 <a href="AnnoStd%EF%B9%96Frame=Main&amp;Edition=MDC&amp;Page=a108056.html#Def_0002">Write</a> !,"Highest number: " <a href="AnnoStd%EF%B9%96Frame=Main&amp;Edition=MDC&amp;Page=a108045.html#Def_0002">Read</a> max
 <a href="AnnoStd%EF%B9%96Frame=Main&amp;Edition=MDC&amp;Page=a108056.html#Def_0002">Write</a> !!,"Number     Square"
 <a href="AnnoStd%EF%B9%96Frame=Main&amp;Edition=MDC&amp;Page=a108056.html#Def_0002">Write</a> !,"======     ======"
 <a href="AnnoStd%EF%B9%96Frame=Main&amp;Edition=MDC&amp;Page=a108031.html#Def_0002">For</a> i=1:1:max <a href="AnnoStd%EF%B9%96Frame=Main&amp;Edition=MDC&amp;Page=a108056.html#Def_0002">Write</a> !,$Justify(i,5),$Justify(i*i,11)
 <a href="AnnoStd%EF%B9%96Frame=Main&amp;Edition=MDC&amp;Page=a108056.html#Def_0002">Write</a> !!
 Quit
</pre>
<p>which is a whole lot less fun, but probably also a lot more effective.</p>
<table width="91%"><tr>
<td width="13%" align="center"><a href="AnnoStd%EF%B9%96Frame=Main&amp;Page=a106001&amp;Edition=1977.html"><img alt="Button for 1977" border="0" src="../image/AnnoStd/1977a.gif"/></a></td>
<td width="13%" align="center"><a href="AnnoStd%EF%B9%96Frame=Main&amp;Page=a106001&amp;Edition=1984.html"><img alt="Button for 1984" border="0" src="../image/AnnoStd/1984a.gif"/></a></td>
<td width="13%" align="center"><a href="AnnoStd%EF%B9%96Frame=Main&amp;Page=a106001&amp;Edition=1990.html"><img alt="Button for 1990" border="0" src="../image/AnnoStd/1990a.gif"/></a></td>
<td width="13%" align="center"><a href="AnnoStd%EF%B9%96Frame=Main&amp;Page=a106001&amp;Edition=1995.html"><img alt="Button for 1995" border="0" src="../image/AnnoStd/1995a.gif"/></a></td>
<td width="13%" align="center"><a href="AnnoStd%EF%B9%96Frame=Main&amp;Page=a106001&amp;Edition=MDC.html"><img alt="Button for MDC" border="0" src="../image/AnnoStd/MDCa.gif"/></a></td>
<td width="13%" align="center"><a href="AnnoStd%EF%B9%96Frame=Main&amp;Page=a106001&amp;Edition=notes.html"><img alt="Button for notes" border="0" src="../image/AnnoStd/notesa.gif"/></a></td>
<td width="13%" align="center"><img alt="Button for examples" border="0" src="../image/AnnoStd/examplesd.gif"/></td></tr></table>
<p>Copyright &copy; Standard Documents; 1977-2023 MUMPS Development Committee;<br/>
Copyright &copy; Examples: 1995-2023 Ed de Moel;<br/>
Copyright &copy; Annotations: 2003-2008 Jacquard Systems Research<br/>
Copyright &copy; Annotations: 2008-2023 Ed de Moel.</p>
<p><b><i>The information in this page is
NOT authoritative and subject to be modified
at any moment.<br/>Please consult the
appropriate (draft) language standard for an
authoritative definition.</i></b></p>
<p><b><i>Some specifications are "approved
for inclusion in a future standard". Note
that the MUMPS Development Committee cannot
guarantee that such future standards will
indeed be published.</i></b></p>
<p><font size="-1">This page most recently updated on 13-Sep-2014, 10:37:42.</font></p>
<p>For comments, <a href="mailto:demoel@jacquardsystems.com?Subject=Annotated%20Standards%20%28Frame%3dMain%2fPage%3da106001%2fEdition%3dexamples%29">contact Ed de Moel (demoel@jacquardsystems.com)</a></p>
</body>
</html>
